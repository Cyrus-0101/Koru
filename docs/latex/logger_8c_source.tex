\doxysection{logger.\+c}
\hypertarget{logger_8c_source}{}\label{logger_8c_source}\index{engine/src/core/logger.c@{engine/src/core/logger.c}}
\mbox{\hyperlink{logger_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00001}00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{logger_8h}{logger.h}}"{}}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00002}00002\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{platform_8h}{platform/platform.h}}"{}}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00004}00004\ \textcolor{comment}{//\ TO-\/DO:\ TEMPORARY}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00005}00005\ \textcolor{preprocessor}{\#include\ <stdio.h>}\ \ \ \textcolor{comment}{//\ for\ printf}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00006}00006\ \textcolor{preprocessor}{\#include\ <string.h>}\ \ \textcolor{comment}{//\ for\ memset}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00007}00007\ \textcolor{preprocessor}{\#include\ <stdarg.h>}\ \ \textcolor{comment}{//\ for\ variable\ argument\ lists\ (va\_list)}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00008}00008\ \textcolor{comment}{//\ \#include\ <unistd.h>\ \ //\ for\ isatty()\ -\/\ seeing\ if\ terminal\ supports\ colour}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00011}00011\ \textcolor{comment}{//\ Terminal\ supports\ colour\ FALSE\ by\ default}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00012}\mbox{\hyperlink{logger_8c_acceded25efdbbd2bf2cbd1bd79a1d91a}{00012}}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{defines_8h_a7415f24c35cb3e16a79f143c5527fdfa}{b8}}\ \mbox{\hyperlink{logger_8c_acceded25efdbbd2bf2cbd1bd79a1d91a}{terminal\_supports\_color}}\ =\ \mbox{\hyperlink{defines_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}};}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00014}00014\ \textcolor{comment}{//\ Initialize\ the\ logging\ system.}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00015}00015\ \textcolor{comment}{//\ For\ now\ it\ just\ returns\ TRUE.\ Later,\ you\ can\ create/open\ a\ log\ file\ here.}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00016}\mbox{\hyperlink{logger_8c_aae701ec9fd1cbb624f28156730027305}{00016}}\ \mbox{\hyperlink{defines_8h_a7415f24c35cb3e16a79f143c5527fdfa}{b8}}\ \mbox{\hyperlink{logger_8c_aae701ec9fd1cbb624f28156730027305}{initialize\_logging}}()\ \{}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00017}00017\ \ \ \ \ \textcolor{comment}{//\ TO-\/DO:\ Create\ log\ file}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00018}00018\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{defines_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}};}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00019}00019\ \}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00021}00021\ \textcolor{comment}{//\ Clean\ up\ the\ logging\ system.}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00022}00022\ \textcolor{comment}{//\ Placeholder\ for\ cleanup,\ like\ flushing\ buffers\ or\ closing\ the\ log\ file.}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00023}\mbox{\hyperlink{logger_8c_a811866002a3bf25ead26b47687cfccdf}{00023}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{logger_8c_a811866002a3bf25ead26b47687cfccdf}{shutdown\_logging}}()\ \{}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00024}00024\ \ \ \ \ \textcolor{comment}{//\ TO-\/DO:\ Cleanup\ logging/write\ queued}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00025}00025\ \}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00027}00027\ \textcolor{comment}{//\ Logs\ a\ message\ at\ a\ given\ level,\ with\ formatting\ like\ printf.}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00028}00028\ \textcolor{comment}{//\ log\_level\ is\ an\ enum\ (e.g.\ LOG\_LEVEL\_INFO,\ LOG\_LEVEL\_ERROR,\ etc.)}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00029}00029\ \textcolor{comment}{//\ message\ is\ a\ printf-\/style\ format\ string.}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00030}00030\ \textcolor{comment}{//\ ...\ are\ the\ variable\ arguments\ for\ formatting.}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00031}\mbox{\hyperlink{logger_8c_abdf99acf6ecc4a6fd2277e74ed3fd8c6}{00031}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{logger_8c_abdf99acf6ecc4a6fd2277e74ed3fd8c6}{log\_output}}(\mbox{\hyperlink{logger_8h_ac91d55174d383848b976a34de843748e}{log\_level}}\ level,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ message,\ ...)\ \{}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00032}00032\ \ \ \ \ \textcolor{comment}{//\ ANSI\ color\ prefixes}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00033}00033\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ level\_colors[6]\ =\ \{}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00034}00034\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)033[1;31m"{}},\ \ \textcolor{comment}{//\ FATAL\ -\/\ bold\ red}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00035}00035\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)033[0;31m"{}},\ \ \textcolor{comment}{//\ ERROR\ -\/\ red}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00036}00036\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)033[0;33m"{}},\ \ \textcolor{comment}{//\ WARN\ \ -\/\ yellow}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00037}00037\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)033[0;32m"{}},\ \ \textcolor{comment}{//\ INFO\ \ -\/\ green}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00038}00038\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)033[0;36m"{}},\ \ \textcolor{comment}{//\ DEBUG\ -\/\ cyan}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00039}00039\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)033[0;37m"{}}\ \ \ \textcolor{comment}{//\ TRACE\ -\/\ light\ gray}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00040}00040\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00042}00042\ \ \ \ \ \textcolor{comment}{//\ Resets\ the\ terminal\ color}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00043}00043\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ level\_reset\ =\ \textcolor{stringliteral}{"{}\(\backslash\)033[0m"{}};\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00044}00044\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00045}00045\ \ \ \ \ \textcolor{comment}{//\ Level\ prefixes\ to\ show\ log\ severity}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00046}00046\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ level\_strings[6]\ =\ \{\textcolor{stringliteral}{"{}[FATAL]:\ "{}},\ \textcolor{stringliteral}{"{}[ERROR]:\ "{}},\ \textcolor{stringliteral}{"{}[WARN]:\ \ "{}},\ \textcolor{stringliteral}{"{}[INFO]:\ \ "{}},\ \textcolor{stringliteral}{"{}[DEBUG]:\ "{}},\ \textcolor{stringliteral}{"{}[TRACE]:\ "{}}\};}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00048}00048\ \ \ \ \ \textcolor{comment}{//\ True\ if\ the\ log\ level\ is\ FATAL\ or\ ERROR}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00049}00049\ \ \ \ \ \mbox{\hyperlink{defines_8h_a7415f24c35cb3e16a79f143c5527fdfa}{b8}}\ is\_error\ =\ level\ <\ \mbox{\hyperlink{logger_8h_ac91d55174d383848b976a34de843748ea99c1e5c8e6d557f3993b9ab54a0107f4}{LOG\_LEVEL\_WARN}};}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00051}00051\ \ \ \ \ \textcolor{comment}{//\ RISKY\ Code\ since\ we\ are\ avoding\ memory\ allocation\ which\ is\ slow}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00052}00052\ \ \ \ \ \textcolor{comment}{//\ It\ technically\ imposes\ a\ 32k\ character\ limit\ on\ a\ single\ log\ entry,\ this\ SHOULD\ NOT\ HAPPEN}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00053}00053\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{defines_8h_a9e3ad5f8e752f01d926ce122d5a5285e}{i32}}\ msg\_length\ =\ 32000;}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00054}00054\ \ \ \ \ \textcolor{comment}{//\ Buffer\ for\ the\ formatted\ message.\ Large\ buffer\ to\ avoid\ malloc.}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00055}00055\ \ \ \ \ \textcolor{keywordtype}{char}\ out\_message[msg\_length];}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00056}00056\ \ \ \ \ memset(out\_message,\ 0,\ \textcolor{keyword}{sizeof}(out\_message));}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00057}00057\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00058}00058\ \ \ \ \ \textcolor{comment}{//\ Format\ original\ message.}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00059}00059\ \ \ \ \ \textcolor{comment}{//\ NOTE:\ Oddly\ enough,\ MS's\ headers\ override\ the\ GCC/Clang\ va\_list\ type\ with\ a\ "{}typedef\ char*\ va\_list"{}\ in\ some}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00060}00060\ \ \ \ \ \textcolor{comment}{//\ cases,\ and\ as\ a\ result\ throws\ a\ strange\ error\ here.\ The\ workaround\ for\ now\ is\ to\ just\ use\ \_\_builtin\_va\_list,}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00061}00061\ \ \ \ \ \textcolor{comment}{//\ which\ is\ the\ type\ GCC/Clang's\ va\_start\ expects.}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00063}00063\ \ \ \ \ \textcolor{comment}{//\ Handle\ variable\ arguments\ manually\ using\ built-\/in\ va\_list}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00064}00064\ \ \ \ \ \_\_builtin\_va\_list\ arg\_ptr;}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00065}00065\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00066}00066\ \ \ \ \ \textcolor{comment}{//\ Start\ reading\ after\ 'message'}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00067}00067\ \ \ \ \ va\_start(arg\_ptr,\ message);}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00069}00069\ \ \ \ \ \textcolor{comment}{//\ Format\ into\ buffer}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00070}00070\ \ \ \ \ vsnprintf(out\_message,\ 32000,\ message,\ arg\_ptr);}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00071}00071\ \ \ \ \ va\_end(arg\_ptr);}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00073}00073\ \ \ \ \ \textcolor{comment}{//\ Final\ buffer\ with\ level\ prefix\ added}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00074}00074\ \ \ \ \ \textcolor{keywordtype}{char}\ out\_message2[msg\_length];}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00075}00075\ \ \ \ \ sprintf(out\_message2,\ \textcolor{stringliteral}{"{}\%s\%s\%s\%s\(\backslash\)n"{}},\ level\_colors[level],\ level\_strings[level],\ out\_message,\ level\_reset);}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00077}00077\ \ \ \ \ \textcolor{comment}{//\ Platform\ Specific\ Output}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00078}00078\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_error)\ \{}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00079}00079\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{platform_8h_adee3e77de1e3374a118e9ebc150c9800}{platform\_console\_write\_error}}(out\_message2,\ level);}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00080}00080\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00081}00081\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{platform_8h_ac352c68fed21ee19eff9a165d1648c4c}{platform\_console\_write}}(out\_message2,\ level);}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00082}00082\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00083}00083\ \}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00084}00084\ }
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00085}00085\ \textcolor{comment}{//\ Called\ when\ an\ assertion\ fails\ to\ log\ useful\ debugging\ info.}}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00086}\mbox{\hyperlink{asserts_8h_a081a03d10de2e1eebf9bb889519687bc}{00086}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{logger_8c_a89ca11b6142a42bebac099dfacf57f59}{report\_assertion\_failure}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ expression,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ message,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ file,\ \mbox{\hyperlink{defines_8h_a9e3ad5f8e752f01d926ce122d5a5285e}{i32}}\ line)\ \{}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00087}00087\ \ \ \ \ \mbox{\hyperlink{logger_8c_abdf99acf6ecc4a6fd2277e74ed3fd8c6}{log\_output}}(\mbox{\hyperlink{logger_8h_ac91d55174d383848b976a34de843748ea779dc8dd26898fb0f88cd5f6e02ba1e5}{LOG\_LEVEL\_FATAL}},\ \textcolor{stringliteral}{"{}Assertion\ Failure:\ \%s,\ message:\ '\%s',\ in\ file:\ \%s,\ line:\ \%d\(\backslash\)n"{}},\ expression,\ message,\ file,\ line);}
\DoxyCodeLine{\Hypertarget{logger_8c_source_l00088}00088\ \}}

\end{DoxyCode}
