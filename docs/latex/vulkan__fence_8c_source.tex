\doxysection{vulkan\+\_\+fence.\+c}
\hypertarget{vulkan__fence_8c_source}{}\label{vulkan__fence_8c_source}\index{engine/src/renderer/vulkan/vulkan\_fence.c@{engine/src/renderer/vulkan/vulkan\_fence.c}}
\mbox{\hyperlink{vulkan__fence_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00001}00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{logger_8h}{core/logger.h}}"{}}}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00003}00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{vulkan__fence_8h}{vulkan\_fence.h}}"{}}}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00013}\mbox{\hyperlink{vulkan__fence_8c_afdf5af68250b20138ac89e34c1d913bd}{00013}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{vulkan__fence_8c_afdf5af68250b20138ac89e34c1d913bd}{vulkan\_fence\_create}}(}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00014}00014\ \ \ \ \ vulkan\_context*\ \mbox{\hyperlink{vulkan__backend_8c_a171b208055a0eb2eeace24e130f74bc9}{context}},}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00015}00015\ \ \ \ \ \mbox{\hyperlink{defines_8h_a3a58feb08f4f45ee137ec358217c3270}{b8}}\ create\_signaled,}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00016}00016\ \ \ \ \ vulkan\_fence*\ out\_fence)\ \{}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00017}00017\ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ to\ signal\ the\ fence\ if\ required.}}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00018}00018\ \ \ \ \ out\_fence-\/>is\_signaled\ =\ create\_signaled;}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00019}00019\ \ \ \ \ VkFenceCreateInfo\ fence\_create\_info\ =\ \{VK\_STRUCTURE\_TYPE\_FENCE\_CREATE\_INFO\};}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00020}00020\ \ \ \ \ \textcolor{keywordflow}{if}\ (out\_fence-\/>is\_signaled)\ \{}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00021}00021\ \ \ \ \ \ \ \ \ fence\_create\_info.flags\ =\ VK\_FENCE\_CREATE\_SIGNALED\_BIT;}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00022}00022\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00024}00024\ \ \ \ \ VK\_CHECK(vkCreateFence(}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00025}00025\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{vulkan__backend_8c_a171b208055a0eb2eeace24e130f74bc9}{context}}-\/>device.logical\_device,}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00026}00026\ \ \ \ \ \ \ \ \ \&fence\_create\_info,}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00027}00027\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{vulkan__backend_8c_a171b208055a0eb2eeace24e130f74bc9}{context}}-\/>allocator,}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00028}00028\ \ \ \ \ \ \ \ \ \&out\_fence-\/>handle));}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00029}00029\ \}}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00031}\mbox{\hyperlink{vulkan__fence_8c_a6761bfc67ef7990942ab60315c2152bc}{00031}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{vulkan__fence_8c_a6761bfc67ef7990942ab60315c2152bc}{vulkan\_fence\_destroy}}(vulkan\_context*\ \mbox{\hyperlink{vulkan__backend_8c_a171b208055a0eb2eeace24e130f74bc9}{context}},\ vulkan\_fence*\ fence)\ \{}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00032}00032\ \ \ \ \ \textcolor{keywordflow}{if}\ (fence-\/>handle)\ \{}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00033}00033\ \ \ \ \ \ \ \ \ vkDestroyFence(}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00034}00034\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{vulkan__backend_8c_a171b208055a0eb2eeace24e130f74bc9}{context}}-\/>device.logical\_device,}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ fence-\/>handle,}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{vulkan__backend_8c_a171b208055a0eb2eeace24e130f74bc9}{context}}-\/>allocator);}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00037}00037\ \ \ \ \ \ \ \ \ fence-\/>handle\ =\ 0;}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00038}00038\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00039}00039\ \ \ \ \ fence-\/>is\_signaled\ =\ \mbox{\hyperlink{defines_8h_a306ebd41c0cd1303b1372c6153f0caf8}{False}};}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00040}00040\ \}}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00042}\mbox{\hyperlink{vulkan__fence_8c_a6b9eca5608aec3856d20de19fa9e3f55}{00042}}\ \mbox{\hyperlink{defines_8h_a3a58feb08f4f45ee137ec358217c3270}{b8}}\ \mbox{\hyperlink{vulkan__fence_8c_a6b9eca5608aec3856d20de19fa9e3f55}{vulkan\_fence\_wait}}(vulkan\_context*\ \mbox{\hyperlink{vulkan__backend_8c_a171b208055a0eb2eeace24e130f74bc9}{context}},\ vulkan\_fence*\ fence,\ \mbox{\hyperlink{defines_8h_ad758b7a5c3f18ed79d2fcd23d9f16357}{u64}}\ timeout\_ns)\ \{}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00043}00043\ \ \ \ \ \textcolor{keywordflow}{if}\ (!fence-\/>is\_signaled)\ \{}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00044}00044\ \ \ \ \ \ \ \ \ VkResult\ result\ =\ vkWaitForFences(}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{vulkan__backend_8c_a171b208055a0eb2eeace24e130f74bc9}{context}}-\/>device.logical\_device,}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ 1,}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ \&fence-\/>handle,}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00048}00048\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{defines_8h_add3ca9eefe3b5b754426f51d3043e579}{True}},}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00049}00049\ \ \ \ \ \ \ \ \ \ \ \ \ timeout\_ns);}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00050}00050\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (result)\ \{}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ VK\_SUCCESS:}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fence-\/>is\_signaled\ =\ \mbox{\hyperlink{defines_8h_add3ca9eefe3b5b754426f51d3043e579}{True}};}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{defines_8h_add3ca9eefe3b5b754426f51d3043e579}{True}};}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ VK\_TIMEOUT:}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logger_8h_a3e40140ad218fd4ef727b1a9009a1bea}{KWARN}}(\textcolor{stringliteral}{"{}vk\_fence\_wait\ -\/\ Timed\ out"{}});}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ VK\_ERROR\_DEVICE\_LOST:}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00058}00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logger_8h_a473bb2cc3b3bf3c93084eeca6cb19132}{KERROR}}(\textcolor{stringliteral}{"{}vk\_fence\_wait\ -\/\ VK\_ERROR\_DEVICE\_LOST."{}});}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ VK\_ERROR\_OUT\_OF\_HOST\_MEMORY:}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logger_8h_a473bb2cc3b3bf3c93084eeca6cb19132}{KERROR}}(\textcolor{stringliteral}{"{}vk\_fence\_wait\ -\/\ VK\_ERROR\_OUT\_OF\_HOST\_MEMORY."{}});}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ VK\_ERROR\_OUT\_OF\_DEVICE\_MEMORY:}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logger_8h_a473bb2cc3b3bf3c93084eeca6cb19132}{KERROR}}(\textcolor{stringliteral}{"{}vk\_fence\_wait\ -\/\ VK\_ERROR\_OUT\_OF\_DEVICE\_MEMORY."{}});}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logger_8h_a473bb2cc3b3bf3c93084eeca6cb19132}{KERROR}}(\textcolor{stringliteral}{"{}vk\_fence\_wait\ -\/\ An\ unknown\ error\ has\ occurred."{}});}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00069}00069\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00070}00070\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00071}00071\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ already\ signaled,\ do\ not\ wait.}}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00072}00072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{defines_8h_add3ca9eefe3b5b754426f51d3043e579}{True}};}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00073}00073\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00075}00075\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{defines_8h_a306ebd41c0cd1303b1372c6153f0caf8}{False}};}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00076}00076\ \}}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00077}00077\ }
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00078}\mbox{\hyperlink{vulkan__fence_8c_a7692eaefbda15ac834201d11d15ad664}{00078}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{vulkan__fence_8c_a7692eaefbda15ac834201d11d15ad664}{vulkan\_fence\_reset}}(vulkan\_context*\ \mbox{\hyperlink{vulkan__backend_8c_a171b208055a0eb2eeace24e130f74bc9}{context}},\ vulkan\_fence*\ fence)\ \{}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00079}00079\ \ \ \ \ \textcolor{keywordflow}{if}\ (fence-\/>is\_signaled)\ \{}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00080}00080\ \ \ \ \ \ \ \ \ VK\_CHECK(vkResetFences(\mbox{\hyperlink{vulkan__backend_8c_a171b208055a0eb2eeace24e130f74bc9}{context}}-\/>device.logical\_device,\ 1,\ \&fence-\/>handle));}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00081}00081\ \ \ \ \ \ \ \ \ fence-\/>is\_signaled\ =\ \mbox{\hyperlink{defines_8h_a306ebd41c0cd1303b1372c6153f0caf8}{False}};}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00082}00082\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{vulkan__fence_8c_source_l00083}00083\ \}}

\end{DoxyCode}
